<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Lecturers · CI/CD Learning</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

  <!-- ───────────  GLOBAL STYLE  ─────────── -->
  <style>
/* RESET */
*{margin:0;padding:0;box-sizing:border-box}

/* PALETTE – אחיד לכל האתר */
:root{
  --brand:#657EEF;      /* כחול ראשי */
  --brand-soft:#eef2ff;
  --accent:#00FFC3;     /* טורקיז */
  --border:#65EFBC;     /* ירקרק עדין */
  --txt:#1f2328;
  --txt-soft:#556;
  --bg:#FFFFFF;
}

body{
  font-family:'Inter',sans-serif;
  background:var(--bg);
  color:var(--txt);
  line-height:1.5;
}

/*
   HEADER
---------------------------------------------*/
header{
  position:fixed;
  inset:0 0 auto 0;
  width:100%;
  padding:16px 10%;
  background:var(--bg);
  border-bottom:1px solid #d8dee4;
  display:flex;
  align-items:center;
  z-index:10;
}
.logo-container{display:flex;align-items:center;gap:12px}
.logo-img{height:32px;width:32px}
.logo-text{font-size:1.25rem;font-weight:600;color:var(--brand)}
.nav-links{list-style:none;display:flex;gap:24px;margin-left:auto}
.nav-links a{color:var(--txt);font-size:14px;font-weight:500;text-decoration:none;position:relative;padding:8px 0}
.nav-links a:hover{color:var(--brand)}
.nav-links .active{color:var(--brand)}
.nav-links .active::after{
  content:'';position:absolute;bottom:0;left:0;width:100%;height:2px;background:var(--brand);
}

/*
   HERO
---------------------------------------------*/
.hero{
  padding:140px 10% 80px;
  background:var(--brand);
  color:#fff;
  border:2px solid var(--border);
  border-radius:12px;
  margin-bottom:40px;
}
.hero h1{font-size:48px;font-weight:700;margin-bottom:16px}
.hero p{font-size:20px;max-width:700px}

/*
   SEARCH
---------------------------------------------*/
.search-wrap{
  width:90%;max-width:420px;margin:32px auto 0;position:relative;
}
.search-wrap input{
  width:100%;padding:12px 20px 12px 46px;font-size:15px;
  border:1px solid var(--border);border-radius:30px;
  transition:.25s;background:#fff;color:var(--txt);
  box-shadow:0 2px 6px rgba(0,0,0,.07);
}
.search-wrap input:focus{outline:none;border-color:var(--brand);box-shadow:0 2px 12px rgba(101,126,239,.25)}
.search-wrap svg{
  position:absolute;left:16px;top:50%;transform:translateY(-50%);
  height:18px;width:18px;color:var(--brand);
}

/*
   GRID / CARD
---------------------------------------------*/
.grid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(260px,1fr));
  gap:30px;
  width:90%;max-width:1400px;margin:45px auto 0;
}
.card{
  background:#fff;
  border:1px solid var(--border);
  border-radius:16px;
  padding:28px 24px;
  box-shadow:0 4px 14px rgba(0,0,0,.06);
  display:flex;flex-direction:column;align-items:center;
  transition:.25s;
}
.card:hover{transform:translateY(-6px);box-shadow:0 8px 24px rgba(0,0,0,.1)}

.avatar{
  height:72px;width:72px;border-radius:50%;
  display:flex;align-items:center;justify-content:center;
  font-size:28px;font-weight:600;color:#fff;
  margin-bottom:18px;user-select:none;
}
.name{font-weight:600;font-size:17px;margin-bottom:4px;text-align:center}
.mail{font-size:14px;color:var(--brand);text-decoration:none;word-break:break-all;text-align:center}
.mail:hover{text-decoration:underline}

.empty{margin:60px 0;text-align:center;color:var(--txt-soft);}

/* RESPONSIVE */
@media(max-width:540px){
  .hero h1{font-size:36px}
  .grid{gap:20px}
}
  </style>
</head>

<body>
<!-- ───── HEADER ───── -->
<header>
  <div class="logo-container">
    <svg class="logo-img" viewBox="0 0 24 24" fill="var(--brand)" xmlns="http://www.w3.org/2000/svg"><path d="M12 0C5.374 0 0 5.373 0 12c0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.652.242 2.873.118 3.176.77.84 1.235 1.91 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576C20.566 21.797 24 17.3 24 12c0-6.627-5.373-12-12-12z"/></svg>
    <span class="logo-text">CI/CD</span>
  </div>
  <ul class="nav-links" id="nav-links"></ul>
</header>

<main>
  <!-- ───── HERO ───── -->
  <section class="hero">
    <h1>Lecturers</h1>
    <p>The experts who guide you through CI / CD & DevOps best-practices.</p>
  </section>

  <!-- ───── SEARCH ───── -->
  <div class="search-wrap">
    <input id="searchInput" type="text" placeholder="Search lecturer…">
    <svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" stroke-width="2"
         viewBox="0 0 24 24"><circle cx="11" cy="11" r="7"/><path d="m16 16 5 5"/></svg>
  </div>

  <!-- ───── LIST / GRID ───── -->
  <div id="grid" class="grid" style="display:none"></div>
  <div id="empty" class="empty" style="display:none">No lecturers found.</div>
</main>

<!-- ──────────  PAGE LOGIC  ────────── -->
<script>
/* ---------- HELPERS ---------- */
function parseJwt(t){
  try{
    const b64=t.split('.')[1].replace(/-/g,'+').replace(/_/g,'/');
    return JSON.parse(decodeURIComponent(atob(b64).split('').map(c=>'%'+('00'+c.charCodeAt(0).toString(16)).slice(-2)).join('')));
  }catch{return null;}
}
function logout(){sessionStorage.clear();location.href="/login";}

/* ---------- HEADER NAV BASED ON TOKEN ---------- */
const token=sessionStorage.getItem("token");
const nav=document.getElementById("nav-links");
if(!token){location.href="/login";}
const user=parseJwt(token)||{};
nav.innerHTML=
  (user.role==="admin"  ? `<li><a href="/admin-dashboard">Admin Dashboard</a></li>` :
   user.role==="lecturer"? `<li><a href="/">Home</a></li><li><a href="/video/courses">Courses</a></li><li><a href="/LecturerProfile">Profile</a></li>` :
                           `<li><a href="/">Home</a></li><li><a href="/video/courses">Courses</a></li><li><a href="/lecturers" class="active">Contact</a></li><li><a href="/StudentProfile">Profile</a></li>`
   ) + `<li><a href="#" onclick="logout()">Logout</a></li>`;

/* ---------- AVATAR COLOR ---------- */
function colorFrom(text){
  let h=0;for(let i=0;i<text.length;i++){h=(h+text.charCodeAt(i)*13)%360;}
  return `linear-gradient(135deg,hsl(${h} 90% 55%),hsl(${(h+45)%360} 90% 45%))`;
}

/* ---------- RENDERERS ---------- */
const gridEl=document.getElementById("grid");
const emptyEl=document.getElementById("empty");
let lecturers=[];

function render(list){
  gridEl.innerHTML='';
  if(!list.length){gridEl.style.display="none";emptyEl.style.display="block";return;}
  list.forEach(l=>{
    const card=document.createElement('div');
    card.className='card';
    const letter=(l.username||'?')[0].toUpperCase();
    card.innerHTML=`
      <div class="avatar" style="background:${colorFrom(letter)}">${letter}</div>
      <div class="name">${l.username||'Unknown'}</div>
      <a class="mail" href="mailto:${l.email}">${l.email}</a>`;
    gridEl.appendChild(card);
  });
  emptyEl.style.display="none";
  gridEl.style.display="grid";
}

/* ---------- FETCH ---------- */
fetch("/api/users/all?role=lecturer",{headers:{Authorization:"Bearer "+token}})
  .then(r=>r.ok?r.json():Promise.reject())
  .then(data=>{lecturers=data||[];render(lecturers);})
  .catch(()=>{emptyEl.textContent="Failed to load lecturers.";emptyEl.style.display="block";});

/* ---------- LIVE SEARCH ---------- */
document.getElementById("searchInput").addEventListener("input",e=>{
  const q=e.target.value.toLowerCase();
  render(lecturers.filter(l=>l.username.toLowerCase().includes(q)));
});
</script>
</body>
</html>
